<!doctype html>
<html>

<head>

    <title>Weather Dot Components</title>

    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

    <!--    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300' rel='stylesheet' type='text/css'>-->

    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
    <link rel="import" href="../../polymer/polymer.html">

    <link rel="import" href="../data/forecast-io.html">
    <link rel="import" href="weather-dot.html">

</head>

<body>
    <style>
        * {
            font-family: "Source Sans Pro";
        }

        main {
            width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
    </style>
    <dom-module id='demo-tag'>
        <style>
            a {
                text-decoration: none;
                color: #00a;
            }

            weather-dot {
                display: inline-block;
                -webkit-border-radius: 5px;
                background: #f5f5f5;
            }
        </style>
        <template>
            <h1>Weather Dot Components</h1>
            <a href="https://github.com/max-pub/polymer-weather">see source on GitHub</a>
            <br/>
            <br/>
            <table>
                <tr>
                    <td>
                        <weather-dot data='{{dot1}}'></weather-dot>
                    </td>
                    <td>
                        -40 till + 40 degrees Celsius
                    </td>
                </tr>
                <tr>
                    <td>
                        <weather-dot data='{{dot2}}'></weather-dot>
                    </td>
                    <td>
                        Clouds and Rain
                    </td>
                </tr>
                <tr>
                    <td>
                        <weather-dot data='{{dot3}}'></weather-dot>
                    </td>
                    <td>
                        Wind
                    </td>
                </tr>

            </table>

            <br/>
            <br/>
            <input placeholder='latitude' value="{{lat::input}}" />
            <input placeholder='longitude' value="{{lon::input}}" />
            <br/>
            <button on-click="setPos" lat='40' lon='74'>New York</button>
            <button on-click="setPos" lat='10' lon='98'>Bangkok</button>
            <button on-click="setPos" lat='52' lon='8'>Muenster</button>
            <br/>
            <br/>

            <!--            <forecast-io lat="{{lat}}" lon="{{lon}}" data="{{data}}"></forecast-io>-->


        </template>
    </dom-module>
    <script>
        Polymer({
            is: 'demo-tag',
            properties: {
                data: {
                    type: Object,
                    observer: 'dataChange'
                },
                hour: Object
            },
            ready: function () {
                DEMO = this;
                this.set('dot1', DOT1);
                this.set('dot2', DOT2);
                this.set('dot3', DOT3);
                this.repeat();
            },
            repeat: function () {
                console.log('repeat now');
                //                var temp = (this.dot1.temperature.feel + 40 + 5) % 80 - 40;
                //                this.dot1 = DOT1;
                this.set('dot1.temperature.feel', (this.dot1.temperature.feel + 40 + 5) % 80 - 40);
                this.set('dot2.cloudCover', (this.dot2.cloudCover + 0.1) % 1);
                this.set('dot2.precipitation.probability', (this.dot2.precipitation.probability + 0.1) % 1);
                console.log('clouds', this.dot2.cloudCover);
                console.log('rain', this.dot2.precipitation.probability);
                console.log('raindrops', Math.round(this.dot2.precipitation.probability * 100 / 10));
                this.set('dot3.wind.speed', (this.dot3.wind.speed + 1) % 25);
                this.set('dot3.wind.bearing', (this.dot3.wind.bearing + 10) % 360);
                //                (this.dot1.temperature.feel + 40 + 5) % 80 - 40
                //                this.set('dot1', DOT1);
                this.debounce('repeat', this.repeat, 500);
            },
            setPos: function (ev) {
                console.log('click', ev.target);
                this.lat = ev.target.getAttribute('lat');
                this.lon = ev.target.getAttribute('lon');
            },
            dataChange: function () {
                return;
                var day = this.data[Object.keys(this.data)[1]];
                if (day) var hour = day.hours[12];
                else var hour = {};
                console.log('day', hour);
                this.set('hour', hour);
            }
        })
    </script>

    <script>
        DOT1 = {
            "temperature": {
                "feel": -40,
                "max": true
            },
            "precipitation": {
                "type": "rain",
                "intensity": 1,
                "probability": 0.5
            },
            "light": 1,
            "cloudCover": 0.43,
            "hour": 20
        };
        DOT2 = {
            "temperature": {
                "feel": 20,
                "max": false
            },
            "precipitation": {
                "type": "rain",
                "intensity": 1,
                "probability": 0
            },
            "wind": {
                "speed": 0,
                "bearing": 127
            },
            "light": 1,
            "cloudCover": 0,
            "hour": 20
        };
        DOT3 = {
            "temperature": {
                "feel": 30,
                "max": false
            },
            "precipitation": {
                "type": "rain",
                "intensity": 1,
                "probability": 0
            },
            "wind": {
                "speed": 0,
                "bearing": 127
            },
            "light": 1,
            "cloudCover": 0,
            "hour": 20
        };
    </script>

    <main>
        <demo-tag></demo-tag>
    </main>

</body>

</html>
